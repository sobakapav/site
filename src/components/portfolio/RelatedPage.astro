---

import PortfolioListItem from '~/components/portfolio/ListItem.astro';
import ResearchListItem from '~/components/portfolio/ListItem.astro';
import ServicesListItem from '~/components/services/ListItem2.astro';
import BlogListItem from '~/components/blog/ListItem.astro';
import BookListItem from '~/components/books/ListItem.astro';
import { getEntry } from 'astro:content';
import { getPermalink } from '~/utils/permalinks';
import { findPostsBySlugs } from '~/utils/blog';

const { collection, page, excerpt, hideFields, styles, overrides } = Astro.props;

var data;
if (collection == 'post') {
  data = JSON.parse(JSON.stringify((await findPostsBySlugs([page]))[0]));
} else {
  const entry = (await getEntry(collection, page));
  if (entry) {
    data = JSON.parse(JSON.stringify(entry.data)); 
  } else {
    console.log(`Cannot find entry ${page} for collection ${collection}`);
    data = {};
  }
}

if (excerpt) {
  data.excerpt = excerpt;
}
data.href = ('research' == collection) ? `/ux-research/${page}` : `/${collection}/${page}`;

---

<Fragment>

  {collection == 'portfolio' && (
    <PortfolioListItem post={data} hideFields={hideFields} styles={styles} overrides={overrides} />
  )}
  
  {collection == 'promo' && (
    <PortfolioListItem post={data} hideFields={hideFields} styles={styles} overrides={overrides} />
  )}

  {collection == 'post' && (
    <BlogListItem post={data} hideFields={hideFields} styles={styles} overrides={overrides} />
  )}

  {collection == 'research' && (
    <ResearchListItem post={data} hideFields={hideFields} styles={styles} overrides={overrides} />
  )}

  {collection == 'services' && (
    <ServicesListItem post={data} hideFields={hideFields} styles={styles} overrides={overrides} />
  )}

  {collection == 'books' && (
    <BookListItem post={data} hideFields={hideFields} styles={styles} overrides={overrides} />
  )}
</Fragment>
